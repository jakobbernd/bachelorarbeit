\chapter{Witt vectors}
The goal of this section is to give a very important example of a comonad:
the Witt vector construction is a functor $\cat{CRing} \to \cat{CRing}$ which
is used frequently in several mathematical fields, especially Number Theory
and Algebraic Geometry. Historically, Witt vectors
have been introduced by Ernst Witt in \cite{witt}, who defined what is today called 
\textit{p-typical Witt vectors} while studying cyclic algebras of degree $p^n$. 
The ring structure on the Witt vectors is highly unintuitive and
the whole construction is rather complicated, which is why this section starts with a 
rigorous, detailed and self-contained introduction to the topic. We will define the p-typical Witt vectors
as well as the \textit{big Witt vectors}, which are due to \cite{cartier}. This is essentially an elaboration of
\cite{HES} (some of the material is also covered in \cite{HES2}), making the proofs as seamless as possible, while only stating what is needed
for proving the final theorem. For different expositions to Witt vectors, consider
\cite{rabinoff}, \cite{serre}. 
The most complete account of Witt vectors that I know of is \cite{hazewinkel}.

\section{Construction of the Witt vectors}

\begin{definition}[truncation set]
    Let $\N$ be the set of positive integers and let $S\subseteq
    \N$ be a subset with the property that $\forall n\in S:$
    if $d$ is a divisor of $n$, then $d\in S$.
    We then say that S is a \textit{truncation set}.
\end{definition}
Now let $S$ be a truncation set. As a set, we define the \textit{Witt ring} $\W_S(A)$ to be $A^S$,
and we will give it a unique ring structure such that the \textit{ghost map}
is a ring homomorphism. Furthermore, if $f \colon A \to B$ is a ring homomorphism,
we define $\W_S(f) \colon \W_S(A) \to \W_S(B)$ to be the function which applies
f componentwise, that is 
$(a_n)_{n \in S} \mapsto (f(a_n))_{n \in S}$.
This construction will turn out to be functorial and we will
see that the Witt vector functor admits a comonadic structure.

\begin{definition}[ghost map]
    We define $w \colon \W_S(A) \to A^S$
    by $(a_n)_{n \in S} \mapsto (w_n)_{n \in S}$ where 
    \[
        w_n = \sum_{d \mid n} d a_d^{n/d}
    \]
    For $a \in \W_S(A)$, we call $(w_n(a))_n = (w_n)_n$ the \textit{ghost coordinates} of $a$.
\end{definition}

Recall that for every prime number $p$, we have the \textit{p-adic valuation map}:
\begin{definition}[p-adic valuation]
   $v_p \colon \mathbb{Z} \to \mathbb{N} \cup\{\infty\}$
    is defined by 
    \[
        v_p(n)=
        \begin{cases}
        \mathrm{max}\{k \in \mathbb{N} : p^k \mid n\} & \text{if } n \neq 0\\
        \infty & \text{if } n=0
        \end{cases} 
    \]

\end{definition}

\begin{lemma}\label{lem: congruences}
    Let $A$ be a ring, $a,b \in A$, $v \in \N$, and p a prime number. Then:
    \[
        a \equiv b \quad \text{mod } pA \implies a^{p^{v}} \equiv b^{p^{v}} \quad \text{mod } p^{v+1}A.
    \]
\end{lemma}
\begin{bigproof}
    We can write $a = b + p \eps$ for some $\eps \in A$,
    then by the binomial theorem we get:
    \[
        a^{p^{v}} = (b+p\eps)^{p^v} = \sum_{i=0}^{p^v} \binom{p^v}{i}b^{p^v-i}(p\eps)^{i}
        = b^{p^v} + \sum_{i=1}^{p^v} \binom{p^v}{i}b^{p^v-i}p^{i}\eps^{i}.
    \]
    \begin{claim*}
    for every $1 \leq i \leq p^v$: $v_p\bigl(\binom{p^v}{i}\bigr) = v - v_p(i)$.
    \end{claim*}
    \begin{smallproof}
        First, note that $v_p(p^v-i) = v - v_p(i).$
        (Indeed: write $i = p^{v_p(i)} \cdot k$ for some $k \in \Z, p \nmid k$.
        Then $p^v-i = p^v-p^{v_p(i)}\cdot k = p^{v_p(i)}\cdot (p^{v-v_p(i)}-k)$,
        hence $p^{v_p(i)} \mid p^v-i$. But $p^{v_p(i)+1} \nmid p^v-i,$ since $p \nmid k$.)

        Now we can apply the p-adic valuation to the following equality:
        \begin{align*}
            i! \cdot \binom{p^v}{i} &= p^v \cdot (p^v-1) \cdot \ldots \cdot (p^v-(i-1)) \\
            \implies v_p \left( i! \cdot \binom{p^v}{i} \right) &= v_p(p^v \cdot (p^v-1) \cdot \ldots \cdot (p^v-(i-1))) \\
            \iff v_p(i!)+ v_p\left(\binom{p^v}{i}\right) &= v_p(p^v) + v_p(p^v-1) + \ldots + v_p(p^v-(i-1)) \\
            \iff v_p(i!)+ v_p\left(\binom{p^v}{i}\right) &= v + v_p((i-1)!) \\
            \iff v_p\left(\binom{p^v}{i}\right) &= v + v_p((i-1)!) - v_p(i!) \\
            \iff v_p\left(\binom{p^v}{i}\right) &= v + v_p\left(\frac{(i-1)!}{i!}\right) \\
            \iff v_p\left(\binom{p^v}{i}\right) &= v - v_p(i)
        \end{align*}
        where we use the multiplicativity of the p-adic valuation.
    \end{smallproof}
        It follows that 
        \begin{align*}
            v_p\left(\binom{p^v}{i} \cdot p^{i}\right) = v - v_p(i) + i \geq v+1
        \end{align*}
        which means that those summands vanish mod $p^{v+1}A$.
\end{bigproof}
The core of the construction is contained in the following Lemma:
\begin{lemma}[Dwork]\label{lem: dwork}
Suppose that for every prime number
$p$ there exists a ring homomorphism $\phi_p \colon A \to A$ with
the property that $\phi_p(a) \equiv a^p$ modulo $pA$. Then for every
sequence $x = (x_n)_{n \in S}$, the following 
are equivalent:
\begin{enumerate}[(i)]
\item The sequence $x$ is in the image of the ghost map
$w \colon \mathbb{W}_S(A) \to A^S.$
\item For every prime number $p$ and every $n \in S$
with $v_p(n) \geqslant 1$,
$$x_n \equiv \phi_p(x_{n/p}) \hskip8mm \text{modulo $p^{v_p(n)}A$.}$$
\end{enumerate}    
\end{lemma}
\begin{bigproof}
    $\hin$ Suppose $x$ is in the image of the ghost map, that means there is a sequence 
    $a = (a_n)_{n \in S}$ such that $x_n = w_n(a)$ for all $n \in S$. 
    We calculate:
    \[
        \phi(x_{n/p}) = \phi(w_{n/p}(a)) = \phi(\sum_{d \mid n/p} d a_d^{n/pd}) =
        \sum_{d \mid n/p} d \cdot \phi(a_d^{n/pd}) 
    \] 
    since $\phi$ is a ring homomorphism and $d \in \N$.
    Now
    \begin{align}
        \label{eq: congruence 1}
        \sum_{d \mid n/p} d \cdot \phi(a_d^{n/pd}) 
        &\equiv
        \sum_{d \mid n/p} d \cdot a_d^{n/d} &\text{\hskip8mm mod} \ p^{v_p(n)}A \\
        \label{eq: congruence 2}
        &\equiv \sum_{d \mid n} d \cdot a_d^{n/d} &\text{\hskip8mm mod} \ p^{v_p(n)}A
    \end{align}
    so we get
    \[
        \phi(x_{n/p}) \equiv \sum_{d \mid n} d \cdot a_d^{n/d} = w_n(a) = x_n \text{\hskip8mm mod} \ p^{v_p(n)}A.
        \]
    \begin{proof}[Proof of~(\ref{eq: congruence 1})]
    First, note that 
\begin{align}\label{eq: multiplication helps congruence} \tag{$\ast$}
        x \equiv y \text{\hskip8mm mod }p^mA \implies dx \equiv dy \text{\hskip8mm mod } p^{m+v_p(d)}A
    \end{align}
    for all $m \in \N, d \in \Z$.
    Now we can write $n/pd = p^{\alpha} \cdot N$ for some $N \in \Z$,
    $p \nmid N$, $\alpha = v_p(n/pd)$. 
    Now by the assumptions of the lemma we get that $\phi_p(a_d^N)
    \equiv a_d^{p \cdot N} \text{mod }pA$, so we can calculate:
    \[
        \phi_p(a_d^{n/pd}) \overset{\mathrm{def.}}{=} \phi_p(a_d^{p^{\alpha} \cdot N})
        = \phi_p(a_d^N)^{p^{\alpha}} \equiv a_d^{(p\cdot N)^{p^{\alpha}}} \text{\hskip8mm mod } p^{\alpha +1}A
    \]
    using Lemma~\ref{lem: congruences} for the last congruence. 
    Now~(\ref{eq: multiplication helps congruence}) and the fact that
    \[
        a_d^{(p \cdot N)^{p^{\alpha}}} = a_d^{p \cdot N \cdot p^{\alpha}} 
        \overset{\mathrm{def.}}{=}
        a_d^{p \cdot n/pd} = a_d^{n/d} 
    \]
    gives us
    \[
        d \cdot \phi_p(a_d^{n/pd}) \equiv d \cdot a_d^{n/d} \text{\hskip8mm mod } p^{\alpha + 1 + v_p(d)}
    \]
    But 
    \[
        \alpha + 1 + v_p(d) \overset{\mathrm{def.}}{=} v_p(n/pd) + 1 + v_p(d)
        = v_p(n/d) + v_p(d) = v_p(n)
    \]
    so it follows that for every d 
    \[
        d \cdot \phi_p(a_d^{n/pd}) \equiv d \cdot a_d^{n/d} \text{\hskip8mm mod } p^{v_p(n)}
    \] 
    which implies (1).
    \end{proof}
    \begin{proof}[Proof of~(\ref{eq: congruence 2})]
        It suffices to show that if $d \mid n$, $d \nmid n/p$, the term 
        $d \cdot a_d^{n/d}$ vanishes mod $p^{v_p(n)}A$.
        But in this case, $v_p(d) = v_p(n)$, hence $d \equiv 0$ mod  $p^{v_p(n)}A$.
    \end{proof} 
    
    $\rueck$ Let $(x_n)_{n \in S}$ be a sequence such that 
    $x_n \equiv \phi_p(x_{n/p}) \hskip8mm mod \ p^{v_p(n)}A \ \forall p\ $prime$, n\in S, v_p(n) \geqslant 1.$
    Define $(a_n)_{n \in S}$ with $w_n((a_n)_{n \in S}) = x_n$ as follows:
    \[a_1 := x_1\]
    and if $a_d$ has been chosen for all $d \mid n$ such that $w_d(a) = x_d$ we see that
    for every prime $p \mid n$:
    \begin{align*}
            x_n &\equiv \phi_p(x_{n/p}) \hskip8mm mod \ p^{v_p(n)}A \\
                &= \phi_p(\sum_{d \mid n/p} d \cdot a_d^{n/pd}) \\
                &= \sum_{d \mid n/p} d \cdot \phi(a_d^{n/pd})
    \end{align*}
    because $\phi_p$ is a ring homomorphism. Using our previous calculations,
    we see that
    \begin{align*}
        \sum_{d \mid n/p} d \cdot \phi(a_d^{n/pd})
        &\overset{(\ref{eq: congruence 1})}{\equiv} \sum_{d \mid n/p} d \cdot a_d^{n/d} 
        \text{\hskip8mm mod } p^{v_p(n)}A \\
        &\overset{(\ref{eq: congruence 2})}{\equiv} \sum_{d \mid n} d \cdot a_d^{n/d} 
        \text{\hskip8mm mod } p^{v_p(n)}A \\
        &\equiv \sum_{d \mid n,d \neq n} d \cdot a_d^{n/d} 
        \text{\hskip8mm mod } p^{v_p(n)}A
    \end{align*}
    In conclusion: 
    \[
    p^{v_p(n)} \mid \left( x_n - \sum_{d \mid n,d \neq n} d \cdot a_d^{n/d} \right)
    \]
    for all $p \mid n$. But this implies that 
    \[
        n \mid \left( x_n - \sum_{d \mid n,d \neq n} d \cdot a_d^{n/d} \right)
    \]
    hence $\exists a_n \in A$ such that 
    \[
        x_n = \sum_{d \mid n,d \neq n} d \cdot a_d^{n/d} + n \cdot a_n
        = \sum_{d \mid n} d \cdot a_d^{n/d}.
    \]
\end{bigproof}
We will often need the following
\begin{lemma} \label{lem: injective ghost map}
    If $A$ is a torsion-free ring, the ghost map is injective.
\end{lemma}
\begin{beweis}
    Let $a = (a_n)_{n \in S}$ such that $w(a) = 0$. This means
    $w_n = 0$ for all $n \in S$. We will prove by induction,
    that $a_n = 0$ for all $n \in S$. First, $a_1 = w_1 = 0$.
    And if $a_d = 0$ for all $d \in S, d < n$ we see that
    \[
        0 = w_n = \sum_{d \mid n} d \cdot a_d^{n/d} = n \cdot a_n 
    \]
    and since A is torsion-free, this implies $a_n = 0$.
\end{beweis}
Now we can finish the construction of the Witt vectors:
\begin{theorem} \label{thm: existence of Witt vectors}
    There exists a unique ring structure such that the ghost map 
    \[
      w:\W_S(A) \to A^s  
    \]
    is a natural transformation of functors from rings to rings.
\end{theorem}
\begin{bigproof}
    \underline{Step 1:} Let $A=\Z [a_n,b_n \mid n \in S]$. Consider the unique
    ring homomorphism 
    \begin{align*}
        \phi_p \colon A \to A; \
        a_n \mapsto a_n^p, \
        b_n \mapsto b_n^p
    \end{align*}
    $\phi_p$ satisfies that $\phi_p(f) \equiv f^p$ modulo $pA$ (Indeed: it suffices to show that $\overline{\phi_p(f)}
    = \overline{f^p}$ in $\Fp[a_n,b_n \mid n \in S]$, which is apparent). \todo{}
    \begin{claim*}
        $w(a)+w(b)$, $w(a) \cdot w(b)$ and $-w(a)$ are in the image of the ghost map.
    \end{claim*}
    \begin{smallproof}
        Since we can use Lemma~\ref{lem: dwork} , it suffices to show that
        for all prime $p$, for all $n \in S$ with $p \mid n$:
        \begin{align*}
           w_n(a)+w_n(b) &\equiv \phi_p(w_{n/p}(a)+w_{n/p}(b)) &\text{\hskip8mm mod } p^{v_p(n)}A \\
           w_n(a)\cdot w_n(b) &\equiv \phi_p(w_{n/p}(a) \cdot w_{n/p}(b)) &\text{\hskip8mm mod } p^{v_p(n)}A \\
           -w_n(a) &\equiv \phi_p(-w_{n/p}(a)) &\text{\hskip8mm mod } p^{v_p(n)}A
        \end{align*} 
        but since $w_n(a)$ and $w_n(b)$ are both in the image of the ghost map, we know that
        $w_n(a) \equiv \phi_p(w_{n/p}(a))$ mod $p^{v_p(n)}A$ and 
        $w_n(b) \equiv \phi_p(w_{n/p}(b))$ mod $p^{v_p(n)}A$.
        The claim now follows using the fact that $\phi_p$ is a ring homomorphism and 
        that congruence is compatible with addition and multiplication.
        \end{smallproof}
    It follows there are sequences $S = (S_n)_{n \in S}$, $P = (P_n)_{n \in S}$
    and $I = (I_n)_{n \in S}$ of polynomials such that
    \[
        w(S) = w(a) + w(b), \ w(P) = w(a) \cdot w(b), \ w(I) = -w(a)
    \]
    Since A is torsion-free, the ghost map is injective by~\ref{lem: injective ghost map}
    and hence, these polynomials are unique.

    \underline{Step 2:} Now let $A'$ be any ring.
    Let $a' = (a'_n)_{n \in S}$, $b' = (b'_n)_{n \in S}$ be two vectors in $\W_S(A')$.
    Then there is a unique ring homomorphism
    \begin{align*}
        e \colon A \to A'; \
        a_n \mapsto a'_n, \
        b_n \mapsto b'_n
    \end{align*}
    such that $\W_S(e)(a) = a'$ and $\W_S(e)(b) = b'$
    (Remember that $A = \Z[a_n,b_n \mid n \in S]$).
    We define:
    \begin{align*}
        a'+ b' &:= \W_S(e)(S) 
        = (S_n(a'_1,\dots,a'_n,b'_1,\dots,b'_n))_{n \in S} \\
        a' \cdot b' &:= \W_S(e)(P) = (P_n(a'_1,\dots,a'_n,b'_1,\dots,b'_n))_{n \in S} \\
        -a' &:= \W_S(e)(I) = (I_n(a'_1,\dots,a'_n,b'_1,\dots,b'_n))_{n \in S}
    \end{align*}
    where $e$ commutes with integer polynomials, since it is a ring homomorphism.
    This is the unique way to define the ring structure on $\W_S(A')$, since functoriality
    of $\W$ forces $\W_S(e)$ to be a ring homomorphism.
\begin{claim*}
    These operations make $\W_S(A)$ into a ring.
\end{claim*}
\begin{smallproof}
    Suppose first that $A'$ is torsion-free, then the ghost map is injective
    and hence the ring axioms are satisfied.
    For the general case, choose a surjective ring homomorphism $g \colon A'' \to A'$
    from a torsion-free ring $A''$(For example, one could take $A''$ to be $\Z A'$).
    Then $\W_S (g)\colon \W_S(A'') \to \W_S(A')$ is again surjective, and since the
    ring axioms are satisfied on the left-hand side, they are satisfied on the right-hand side.
    \todo{}
\end{smallproof}
\begin{claim*}
    $w \colon \W_S(A) \to A^S$ is a natural ring homomorphism.
\end{claim*}
$w$ is natural, because for $f \colon A \to B$:
\[
    \begin{tikzcd}
        \W_S(A) \arrow[r,"\W_S(f)"] \arrow[d,"w"] 
          & \W_S(B) \arrow[d,"w"] \\
        A^S \arrow[r,"f^S"]
          & B^S
    \end{tikzcd}
\]
commutes since $f$ is a ring homomorphism, hence commutes with the integer polynomials $w_n$.
To show that $w$ is a ring homomorphism, let $a',b' \in \W_S(A)$. Then: 
\begin{align*}
    w_n(a'+b') &= w_n(\W_S(e)(S)) = e(w(S)) = e(w(a)+w(b)) \\
    &= e(w(a)) + e(w(b)) = w(a') +w(b')
\end{align*}
and analogously $w(a' \cdot b') = w(a') \cdot w(b')$.
\todo{}
\end{bigproof}
\begin{cor} \label{cor: ghost components are nat trafos}
    $w_n \colon \W_S(A) \to A$ is a natural ring homomorphism for all $n \in S$.
\end{cor}
\begin{lemma}
    The zero element in $\W_S(A)$ is given by $(0,0,0,\dots)$ and the
    unit in $\W_S(A)$ is given by $(1,0,0,\dots)$.
\end{lemma}
\begin{beweis}
    (For better readability, this proof assumes $S = \N$, but the general proof is exactly the same.)
    Suppose first that $A = \Z[a_n, b_n \mid n \in \N]$. Let $a = (a_n)_n$ be a Witt vector.
    Then:
    \[
       w((0,0,0,\dots)) = (0,0,0,\dots) 
    \]
    since $w_n(0,0,0,\dots) = 0$ for all $n$.
    \[
        w((1,0,0,\dots)) = (1,1,1,\dots)
    \] 
    since $w_n(1,0,0,\dots) = 1^n = 1$ for all $n$.
    By injectivity of the ghost map, the claim follows, because $(0,0,0,\dots)$
    and $(1,0,0,\dots)$ are the zero element respectively the unit in $A^{\N}$.
    In the general case: For $A'$ any ring, $(a'_n)_n \in \W_S(A')$,
    $(a'_n)_n + (0,0,\dots)$ is defined as $(S_1(a'_1,0),S_2(a'_1,a'_2,0,0),\dots)$
    and since $(S_1(a_1,0),S_2(a_1,a_2,0,0),\dots) = (a_1,a_2,\dots) \in \Z[a_n,b_n \mid n \in \N]$,
    these polynomial equations still hold if we plug in a different sequence. The
    same reasoning show that $(1,0,\dots)$ is the unit.
\end{beweis}
\begin{proposition} \label{prop: W is a functor}
    $\W_S(\_)$ is a functor $\cat{CRing} \to \cat{CRing}$.
\end{proposition}
\begin{beweis}
$\W_S(\id) = \id$ and $\W_S(g \circ f) = \W_S(g) \circ W_S(f)$
are clear, since $\W_S(\_)$ on morphisms is identical with the countable product
functor $(\_)^{\N}$. All that is left to show is that for a ring homomorphism
$f\colon A \to B$, $\W_S(f) \colon W_S(A) \to W_S(B)$ is again 
a ring homomorphism.
\[
    \W_S(f)(1,0,\dots) = (f(1),f(0),\dots) = (1,0,\dots)
\]
Now let $x = (x_n)_n, y = (y_n)_n$ be two Witt vectors.
\begin{align*}
    \W_S(f)(x+y) &= \W_S(f)(S_n(x_1,\dots,x_n,y_1,\dots,y_n))_n \\
    &= (f(S_n(x_1,\dots,x_n,y_1,\dots,y_n)))_n \\
    &= (S_n(f(x_1),\dots,f(x_n),f(y_1),\dots,f(y_n)))_n \\
    &= \W_S(f)(x) + \W_S(f)(y)
\end{align*}
where $f$ commutes with integer polynomials since it is a ring homomorphism.
An identical computation shows that
\[
    W_S(f)(x \cdot y) = \W_S(f)(x) \cdot \W_S(f)(y)
\]
\end{beweis}
\section{The Verschiebung, Frobenius and Teichmüller maps}
We have various operations on Witt vectors that are of interest.
\begin{definition}[Restriction map]
    If $T \subseteq S$ are two truncation sets, the \textit{restriction from S to T}
    \[
      R_T^S \colon \W_S(A) \to \W_T(A)  
    \]
    is a natural ring homomorphism. 
    This follows from the fact that
    for the polynomials used to define addition and multiplication in the Witt vector ring
    we have $S_n,P_n \in \Z[a_1,\dots,a_n,b_1,\dots,b_n]$(see the proof of Dwork's lemma, $(\Leftarrow)$).
    
\end{definition}
\todo{}
If $S\subseteq \N$ is a truncation set, $n \in \N$, then
\[
   S/n := \{d \in \N \mid nd \in S\}
\]
is again a truncation set.
\begin{definition}[Verschiebung] \
    Define 
    \[
        V_n \colon \W_{S/n} \to \W_S(A);\  
        V_n((a_d)_{d \in S/n})_m := 
        \begin{cases}
            a_d, &\quad \text{if $m=n \cdot d$} \\
            0,  &\quad \text{else}
        \end{cases}
    \]
    which is called the \textit{n-th Verschiebung map}. Furthermore define
    \[
        \widetilde{V_n} \colon A^{S/n} \to A^S;\ 
        \widetilde{V_n}((x_d)_{d \in S/n})_m := 
        \begin{cases}
            n \cdot x_d, &\quad \text{if $m=n \cdot d$} \\
            0,  &\quad \text{else}
        \end{cases}
    \]
\end{definition}
\begin{lemma} \label{lem: verschiebung is additive}
    The Verschiebung map $V_n$ is additive.
\end{lemma}
\begin{bigproof}
    \begin{claim*}
        \begin{tikzcd}
            \W_{S/n}(A) \arrow[r,"w"] \arrow[d,"V_n"]
            & A^{S/n} \arrow[d,"\widetilde{V_n}"]\\
            \W_S(A) \arrow[r,"w"]
            & A^S
        \end{tikzcd}
        commutes.
    \end{claim*}
    \begin{smallproof}
    Let $a = (a_d)_{d \in S/n} \in \W_{S/n}(A).$ Let $m \in S$.
    \begin{itemize}
        \item case 1: $m \neq n \cdot d$ $\forall d \in S$: Then
        $\widetilde{V_n}(w(a))_m = (\widetilde{V_n}(w_d)_{d \in S/n})_m = 0$ and
        \[
          w(V_n(a))_m = \sum_{k \mid m, k = nd} k \cdot a_d^{m/k} = 0
        \]
        because if there would be $k \mid m, k = nd$, this would mean that 
        $m =k \cdot d' = n \cdot d \cdot d'$ for $d,d' \in S$ and then $d \cdot d' \mid m$
        which is a contradiction to case 1.
        \item case 2: $m = n \cdot d$ for some $d \in S$:
        \begin{align*}
        \widetilde{V_n}(w(a))_m &= (\widetilde{V_n}(w_d)_{d \in S/n})_m 
          = n \cdot w_d = n \cdot \sum_{k \mid d} k \cdot a_k^{d/k}. \\
          w(V_n(a))_m &= w_m(V_n(a)) = \sum_{k \mid nd}k \cdot (V_n(a))_k^{nd/k} \\
          &= \sum_{k \mid nd, k = nd_k} k \cdot a_{d_k}^{nd/k}
          = n \cdot \sum_{k \mid nd, k = nd_k} d_k \cdot a_{d_k}^{nd/nd_k} \\
          &= n \cdot \sum_{k \mid nd, k = nd_k} d_k \cdot a_{d_k}^{d/d_k} 
          = n \cdot \sum_{k \mid d} k \cdot a_{k}^{d/k} \\
        \end{align*}
        because $nd_k \mid nd \iff d_k \mid d$ for $d_k,d,n \in \N$.
    \end{itemize}
    \end{smallproof}
    $\widetilde{V_n}$ is obviously additive, so assume now that $A$ is torsion-free.
    Then the ghost map is injective, so it is enough to check that 
    $w(V_n(a+b)) = w(V_n(a)+V_n(b)$) for $a,b \in \W_{S/n}$.
    Since 
    \[
        \begin{tikzcd}
            \W_{S/n}(A) \arrow[r,"w"] \arrow[d,"V_n"]
            & A^{S/n} \arrow[d,"\widetilde{V_n}"]\\
            \W_S(A) \arrow[r,"w"]
            & A^S
        \end{tikzcd}
    \]
    commutes, we calculate:
    \begin{align*}
        w(V_n(a+b)) &= \widetilde{V}_n(w(a+b))= \widetilde{V}_n(w(a)+w(b)) \\
        &= \widetilde{V}_n(w(a))+\widetilde{V}_n(w(b))
        = w(V_n(a))+w(V_n(b))= w(V_n(a)+V_n(b))
    \end{align*}
    For the general case, choose a surjective ring homomorphism $g \colon A \to A'$,
    where $A$ is torsion-free. Then the diagram
    \[
       \begin{tikzcd}
           \W_{S/n}(A) \arrow[r,"\W_{S/n}(g)",twoheadrightarrow] \arrow[d,"V_n"] 
             & \W_{S/n}(A') \arrow[d,"V_n"] \\
           \W_S(A) \arrow[r,"\W_S(g)",twoheadrightarrow]
             & \W_S(A')
       \end{tikzcd} 
    \]
    clearly commutes and since $\W_{S/n}(g)$ is surjective, there are $x,y \in \W_{S/n}(A)$
    such that $\W_{S/n}(g)(x)=a, \W_{S/n}(g)(y)=b$.
    Then 
    \begin{align*}
        V_n(a+b) &= V_n(\W_{S/n}(g)(x+y))=\W_S(g)(V_n(x+y)) \\
        &= \W_S(g)(V_n(x)) + \W_S(g)(V_n(y)) = V_n(\W_{S/n}(g)(x)) + V_n(\W_{S/n}(g)(y)) \\
        &= V_n(a)+V_n(b)
    \end{align*}
    \todo{}
\end{bigproof}
Next, we will introduce the \textit{frobenius homomorphism}, which will play 
an important rule in the proof of the comonadic structure of $\W$ as well.
For that, first define $\widetilde{F}_n \colon A^S \to A^{S/n} \ $
by $\widetilde{F}_n((x_m)_{m \in S}) = (x_{nm})_{m \in S/n}$.
\begin{lemma}[Frobenius homomorphism] \label{lem: frobenius}
    There exists a unique natural ring homomorphism
    \[
      F_n \colon \W_S(A) \to \W_{S/n}(A)  
    \]
    such that the diagram 
    \[
        \begin{tikzcd}
            \W_S(A) \arrow[r,"w"] \arrow[d,"F_n"] 
              & A^S \arrow[d,"\widetilde{F}_n"] \\
            \W_{S/n}(A) \arrow[r,"w"]
              & A^{S/n}
        \end{tikzcd}        
    \]
    commutes.
\end{lemma}
    We call $F_n$ the \textit{nth Frobenius homomorphism}.
    The commutativity of the diagram above is equivalent to
    commutativity of the following diagram for every $d \in S/n$:
    \[
        \begin{tikzcd}
            \W_S(A) \arrow[d,"F_n"] \arrow[dr,"w_{nd}"] \\
            \W_{S/n}(A) \arrow[r,"w_d"'] 
            & A
        \end{tikzcd}
    \]

\begin{proof}[Proof of Lemma~\ref*{lem: frobenius}]
    We construct $F_n$ similar to the construction of the ring operations on $\W_S(A)$ 
    using Lemma~\ref{lem: dwork} again. So let $A$ be the polynomial ring $\Z[a_i\mid i \in S]$
    , let $a = (a_i)_{i \in S}$ and let $\phi_p$ be the unique ring homomorphism
    $a_i \mapsto a_i^p$. It satisfies $\phi_p(a) \equiv a^p$ mod $pA$ 
    (compare the proof of~\ref{thm: existence of Witt vectors}). Then Lemma~\ref{lem: dwork} shows that the sequence
    $\widetilde{F}_n(w(a)) \in A^{S/n}$ is in the image of a unique element
    \[
      F_n(a)  =(f_{n,d}(a))_{d \in S/n}
    \]
    by the ghost map, where the $f_{n,d}$ are integer polynomials with indeterminates
    $a_i$. (Indeed: we have 
    \begin{align*}
        \phi_{p}((\widetilde{F}_n(w(a)))_{m/p}) &= \phi_{p}((w_{nm/p})) 
        = \sum_{k \mid nm/p} k \cdot a_k^{nm/k} \\
        \widetilde{F}_n(w(a))_m
        &= w_{nm}
        = \sum_{k \mid nm} k \cdot a_k^{nm/k}
    \end{align*}
    and both sums are congruent mod $p^{v_p(m)}A$.)
    If $A'$ is any ring and if $a' = (a'_i)_{i \in S}$ is a vector in $\W_S(A)$,
    then we define
    \[
      F_n(a') := \W_{S/n}(e_{a'})(F_n(a)) = (f_{n,d}(a'))_{d \in S/n}
    \]
    where $e_{a'} \colon A \to A'$ is the unique ringhomomorphism that maps $a$ to $a'$.
    Now since $\widetilde{F}_n$ is clearly a ring homomorphism,
    we can argue similar as in the proof of Lemma~\ref{lem: verschiebung is additive}
    to show that $F_n$ is a ring homomorphism. $F_n$ is natural, since for a ring homomorphism
    $f \colon A' \to B'$ the diagram
    \[
       \begin{tikzcd}
           \W_S(A') \arrow[r,"\W_S(f)"] \arrow[d,"F_n"] 
             & \W_S(B') \arrow[d,"F_n"] \\
           \W_{S/n}(A') \arrow[r,"\W_{S/n}(f)"]
             & \W_{S/n}(B')
       \end{tikzcd} 
    \]
    commutes, because $f$ commutes with integer polynomials, as it is a ring homomorphism.
    Lastly, uniqueness of $F_n$ follows from naturality, since for $a' \in A'$, the following diagram has to 
    commute:
    \[
        \begin{tikzcd}
            \W_S(A) \arrow[r,"\W_S(e_{a'})"] \arrow[d,"F_n"] 
              & \W_S(A') \arrow[d,"F_n"] \\
            \W_{S/n}(A) \arrow[r,"\W_{S/n}(e_{a'})"]
              & \W_{S/n}(A')
        \end{tikzcd} 
     \]
\end{proof}
Note that for $n,m \in \N$ we have $(S/n)/m = S/nm$ by definition.
\begin{lemma} \label{lem: F_n after F_m is F_{nm}}
    Let $n,m \in \N$.
    Then 
    \[F_n \circ F_m = F_{nm}.\]
\end{lemma}
\begin{beweis}
    We have $\widetilde{F}_n \circ \widetilde{F}_m = \widetilde{F}_{nm}$,
    since
    \[
       \widetilde{F}_n(\widetilde{F}_m(x_d)_{d \in S}) 
       = \widetilde{F}_n((x_{md})_{d \in S/m})
       = (x_{nmd})_{d \in S/nm}
       = \widetilde{F}_{nm}((x_d)_{d \in S}).
    \]
    Now suppose that $A$ is torsion-free, which means that the ghost map is injective.
    We have the following commutative diagram:
    \[
        \begin{tikzcd}
            \W_S(A) \arrow[r,"w",hook] \arrow[d,"F_n"] 
              & A^S \arrow[d,"\widetilde{F}_n"] \\
            \W_{S/n}(A) \arrow[r,"w",hook] \ar[d,"F_m"]
              & A^{S/n} \ar[d,"\widetilde{F}_m"]\\
            \W_{S/nm}(A) \ar[r,"w",hook]
            & A^{S/nm}
        \end{tikzcd}      
    \]
    and then $w \circ (F_n \circ F_m) = \widetilde{F}_n \circ \widetilde{F}_m \circ w 
    = \widetilde{F}_{nm} \circ w = w \circ (F_{nm})$
    which implies $F_n \circ F_m = F_{nm}$, since w is injective, hence a mono.
    Now, for the general case choose $g \colon A \to A'$ surjective, then we have the following
    commuting diagram:
    \[
        \begin{tikzcd}
            \W_S(A) \arrow[r,"\W(g)",twoheadrightarrow] \arrow[d,"F_n"] 
              & \W_S(A') \arrow[d,"F'_n"] \\
            \W_{S/n}(A) \arrow[r,"\W(g)",twoheadrightarrow] \ar[d,"F_{m}"]
              & \W_{S/n} \ar[d,"F'_m"] \\
              \W_{S/nm}(A) \ar[r,"\W(g)",twoheadrightarrow] 
              & \W_{S/nm}(A')
        \end{tikzcd}
    \]
    and then $F'_n \circ F'_m \circ \W(g) = \W(g) \circ F_n \circ F_m = \W(g) \circ F_{nm}
    = F'_{nm} \circ \W(g)$ which implies $F'_n \circ F'_m$ since $\W(g)$ is surjective, hence an epi.
\end{beweis}
\begin{lemma}\label{lem: F_1 = id}
    $F_1 = \id \colon W_S(A) \to W_S(A)$.
\end{lemma}
\begin{beweis}
    clearly, $\widetilde{F_1} = \id_{A^S}$, now if $A$ is torsion-free, the claim follows,
    and in the general case we can argue as before.
\end{beweis}
\begin{definition}[teichmüller representative]
    The \textit{teichmüller representative} is the map
    \[
      \tau \colon A \to \W_S(A)  
    \]
    defined by
    \[
      (\tau(a))_m =   
      \begin{cases}
        a, & \text{if } m = 1\\
        0, & \text{else}
        \end{cases}
    \]
\end{definition}
\begin{lemma} \label{lem: teichmüller is multiplicative}
    The teichmüller map is multiplicative.
\end{lemma}
\begin{beweis}
    The map $\widetilde{\tau} \colon A \to A^S$; $(\widetilde{\tau}(a))_n = a^n$
    is multiplicative and there is a commutative diagram
    \[
        \begin{tikzcd}
              & A \arrow[rd,"\widetilde{\tau}"] \\ %so kann man btw pfeile umdrehen (leftarrow)
            \W_S(A) \arrow[ru, leftarrow,"\tau"] \arrow[rr,"w"]
                && A^S.
        \end{tikzcd}
    \]
    Indeed, $w_n(\tau(a)) = w_n((a,0,0,\dots)) = a^n$
    by definition of $w_n$.

\end{beweis}
\section{The comonad structure of Witt vectors}
We will need the following lemma:
\begin{lemma}\label{lem: non-zero divisor}
    Let $m \in \Z$. If $m$ is a non-zero divisor in A, then it is a
    non-zero divisor in $\W_S(A)$ as well.
\end{lemma}
\begin{beweis}
    We can assume that $S$ is finite, since $\W_S(A)$ is the inverse limit
    of all $\W_T(A)$ where $T$ is a finite sub-truncation set of S, together with the fact that
    the inverse limit is left-exact, hence preserves injectivity. \todo{}
    We will prove the Lemma by induction over $\abs{S}$.
    If $S = \emptyset$, the statement is trivial, so let $\abs{S} = 1$, this means
    that $S = \{n\}$ for some $n \in \N$, but then $\W_{\set{n}}(A) \cong \W_{\set{1}}(A) = A$ via $V_n$.
    Now for the induction step, let $n \in S$ be maximal and let $T = S - \{n\}$.
    Then $S/n = \{1\}$ and therefore we have a short exact sequence 
    \[
    \begin{tikzcd}
        0 \arrow[r]
          & A \arrow[r,"V_n"]
            & \W_S(A) \arrow[r,"R_T^S"]
              & W_T(A) \arrow[r]
                & 0
    \end{tikzcd}
    \]
    since $V_n$ maps $a$ to $(0,\dots,a)$ and $R_T^S$ forgets the last coordinate.
    We can extend the sequence to the following commutative diagram:
    \[
    \begin{tikzcd}
        0 \arrow[r] 
        & A \arrow[r] \arrow[d,"\cdot m"] 
          & \W_S(A) \arrow[r] \arrow[d,"\cdot m"]
            & \W_T(A) \arrow[d,"\cdot m"] \arrow[r]
                & 0 \\
        0 \arrow[r]
           & A \arrow[r]
            & \W_S(A) \arrow[r]
              & \W_T(A) \arrow[r]
                & 0 
    \end{tikzcd}
    \]
    Now $m$ being a non-zero divisor is equivalent to $\cdot m$ being injective, but if the
    two outer vertical maps are injective, applying the snake lemma yields that the middle map has to be 
    injective, too.
\end{beweis}
\begin{cor} 
    \label{cor: A torsion-free implies W(A) torsion-free}
    If $A$ is torsion-free, then $\W_S(A)$ is torsion-free as well.
\end{cor}
\begin{definition}[p-typical and big Witt vectors]
    For a prime $p$, the set $P := \set{1,p,p^2,\dots}$ is a truncation set.
    The ring $\W_P(A)$ is called the \textit{p-typical Witt vectors}, the ring
    $\W_n(A) := \W_{\set{1,p,p^2,\dots,p^n}}(A)$ is called the \textit{p-typical
    Witt vectors of length n}.    
    In most of the literature, elements in those two rings are indexed by their exponent.
    We define the \textit{big Witt vectors} to be 
    $\W(A) := \W_{\N}(A)$
\end{definition}
For the construction of a natural transformation $\W(A) \to \W(\W(A))$
we want to use Lemma~\ref{lem: dwork} again. Hence we first show:
\begin{lemma} \label{lem: frobenius lifts frobenius}
    Let $p$ be a prime number, let $A$ be any ring.
    Then the ring homomorphism $F_p \colon \W(A) \to \W(A)$  
    satisfies $F_p(a) \equiv a^p \ mod \ pA.$
\end{lemma}
\begin{beweis}
    Suppose first, that $A = \Z[a_1,a_2,\dots]$ and let $a = (a_1,a_2,\dots)$. Since
    \begin{align*}
        F_p(a) &\equiv a^p \hskip8mm &\text{mod } p\W(A) \\
        \iff F_p(a)-a^p &\equiv 0 \hskip8mm &\text{mod } p\W(A) \\
        \iff F_p(a) - a^p &\in p\W(A) \\
    \end{align*}
    it suffices to show there exists $b \in \W(A)$ such that $F_p(a)-a^p = p\cdot b$.
    By Lemma~\ref{lem: non-zero divisor}, this element is unique. Applying the ghost map gives us:
    \begin{align*}
        w_n(F_p(a) - a^p) = w_n(F_p(a))-w_n(a)^p = w_{pn}(a) - w_n(a)^p 
        = \sum_{d \mid pn}d \cdot a_d^{pn/d} - ( \sum_{d \mid n} d \cdot a_d^{n/d})^p
    \end{align*}
    using Lemma~\ref{lem: frobenius}. This is now congruent to $0$ mod $pA$:
    modulo $p$, $x \mapsto x^p$ is a ring homomorphism, so the second summand is congruent
    to $\sum_{d \mid n}d \cdot a_d^{np/d}$. Now if $d \mid pn$, $d \nmid n$, then
    $p \mid n$, which shows that the two summands are congruent.
    It follows that there exists $x = (x_n)_{n \in \N}$ such that 
    \begin{align}
        \label{eq: p cdot x_n}
        p \cdot x_n = w_n(F_p(a)-a^p)
        \iff x_n = \frac{1}{p} \cdot w_n(F_p(a)-a^p)
    \end{align}
    We want to show that $x = w(b)$ for some $b \in \W(A)$.
    Then 
    \[
        w(p \cdot b) = p \cdot w(b) = p \cdot x = w(F_p(a)-a^p)
    \]
    which implies by injectivity of $w$ that $p \cdot b = F_p(a) -a^p$.
    For this, we want to use Lemma~\ref{lem: dwork} again.
    Consider the unique ring homomorphism $\phi_l \colon A \to A$ which maps
    $a_n$ to $a_n^l$. By Lemma~\ref{lem: dwork} it suffices to show: 
    \[
        x_n \equiv \phi_l(x_{n/l}) \text{\hskip8mm mod }l^{v_l(n)}
    \]
    for all primes $l$, for all $n \in N$ with $l \mid n$.
    But this is equivalent to:
    \[
        w_n(F_p(a)-a^p) \equiv \phi_l(w_{n/l}(F_p(a)-a^p))
         \text{\hskip8mm mod }l^{v_l(n)A} \quad \forall l \neq p, \forall n \in l\N
    \]
    and 
    \[
      w_n(F_p(a)-a^p) \equiv \phi_p(W_{n/p}(F_p(a)-a^p)) 
      \text{\hskip8mm mod } p^{v_p(n)+1}A \quad \forall n \in p\N
    \]
    (Using~\ref{eq: p cdot x_n} we have for $l=p$:
    \begin{align*}
        x_n \equiv \phi_p(x_{n/p}) \text{ mod }p^{v_p(n)}A
        &\iff p \cdot x_n \equiv p \cdot \phi_p(x_{n/p}) 
        &\text{mod }p^{v_p(n)+1}A \\
        &\overset{\ref{eq: p cdot x_n}}{\iff} w_n(F_p(a)-a^p) \equiv \phi_p(w_{n/p}(F_p(a)-a^p)) 
        &\text{mod }p^{v_p(n)+1}A
    \end{align*}
    and for $l \neq p$: 
    \begin{align*}
        x_n \equiv \phi_l(x_{n/l}) \text{ mod }l^{v_l(n)}A
        &\iff p \cdot x_n \equiv p \cdot \phi_l(x_{n/l}) 
        &\text{mod }l^{v_l(n)}A \\
        &\overset{\ref{eq: p cdot x_n}}{\iff} w_n(F_p(a)-a^p) \equiv \phi_l(w_{n/l}(F_p(a)-a^p)) 
        &\text{mod }l^{v_l(n)}A.)
    \end{align*}
    For $l \neq p$, the statement follows directly from Lemma~\ref{lem: dwork}.
    So now let $l = p$, let $n \in p\N$. Then:
    \begin{align*}
        &w_n(F_p(a)-a^p) - \phi_p(w_{n/p}(F_p(a)-a^p)) \\
        = \ &w_{pn}(a) - w_n(a)^p - \phi_p(w_n(a)) + \phi_p(w_{n/p}(a))^p \\
        = \ &\sum_{d \mid pn}d \cdot a_d^{pn/d} - ( \sum_{d \mid n}d \cdot a_d^{n/d} )^p 
        - \sum_{d \mid n}d \cdot a_d^{np/d} + ( \sum_{d \mid n/p}d \cdot a_d^{n/d} )^p
    \end{align*}
    using Lemma~\ref{lem: frobenius} for the first equality.
    Now if $d \mid pn, d \nmid n$, then $v_p(d) = v_p(n)+1$, hence the first and third summand 
    cancel each other out, and for the second and forth summand, using~\ref{eq: congruence 2} and~\ref{lem: congruences}
    again we have 
    \[
        \sum_{d \mid n}d \cdot a_d^{n/d} \equiv \sum_{d \mid n/p}d \cdot a_d^{n/d}
        \text{ mod }p^{v_p(n)}A
        \implies ( \sum_{d \mid n}d \cdot a_d^{n/d} )^p  \equiv 
        ( \sum_{d \mid n/p}d \cdot a_d^{n/d} )^p
        \text{ mod }p^{v_p(n)+1}A
    \]
    which proves the claim. Now in the general case, let $a' \in \W(A')$.
    Then \[
        F_p(a') = \W g (F_p(a)) = \W g(a^p + p \cdot r) = (a')^p + p \cdot \W g(r)
    \]
    for some $r \in A$.
\end{beweis}

\begin{proposition} \label{prop: existence of diagonal}
    There exists a unique natural transformation
    \[
      \Delta \colon \W(A) \to \W(\W(A))  
    \]
    such that $w_n(\Delta(a))=F_n(a)$ for all $a \in A, n \in \N$.
\end{proposition}
\begin{beweis}
By naturality of $\Delta$, we can assume $A$ to be torsion-free. (If $A'$ is 
an arbitrary ring, then the naturality implies uniqueness in the same way we argued
in~\ref{lem: frobenius}.)
\todo{}
By applying Corollary~\ref{cor: A torsion-free implies W(A) torsion-free}
twice, we get that the ghost map 
\[
    w \colon \W(\W(A)) \to \W(A)^{\N}
\]
is injective. Now by Lemma~\ref{lem: frobenius lifts frobenius}, 
$F_p \colon \W(A) \to \W(A)$ satisfies $F_p(a) \equiv a^p$ mod $p\W(A)$,
hence we can use Lemma~\ref{lem: dwork} again and just show that
\[
  F_n(a)   \equiv F_p(F_{n/p}(a)) \text{\hskip8mm mod }p^{v_p(n)}A
\]
for all $p$ prime, $n \in p\N$. But this immediately follows from 
Lemma~\ref{lem: F_n after F_m is F_{nm}}, so there is a unique $\Delta(a)
\in \W(\W(A))$ such that $w_n(\Delta(a)) = F_n(a)$. Now $\Delta$ is a natural 
ring homomorphism by construction, arguing as in~\ref{lem: frobenius}.
\end{beweis}
Recall that by~\ref{cor: ghost components are nat trafos},
$w_1 \colon \W(A) \to A$; $(a_n)_{n \in \N} \mapsto a_1$
is a natural transformation of functors $\W \Rightarrow \id_{\cat{CRing}}$.
\begin{theorem} \label{thm: comonad structure}
    The functor $\W(\_) \colon \cat{CRing} \to \cat{CRing}$ together with the
    natural transformations $\Delta \colon \W \Rightarrow \W^2,$ $w_1 \colon 
    \W \Rightarrow \id_{\cat{CRing}}$ form a comonad $(\W,w_1,\Delta)$.
\end{theorem}
\begin{bigproof}
    By naturality of $\Delta$, we can assume that $A$ is torsion-free,
    because if $A'$ is an arbitrary ring, to show the~\refassociativity axiom,
    we can choose a torsion-free ring $A$ and $g \colon A \to A'$ surjective as before and then consider the following
    cube:
    \[
        \begin{tikzcd}[row sep=1.5em, column sep = 1.5em]
            \W(A) \arrow[rr,"\Delta_A"] \arrow[dr,swap,"\W(g)",twoheadrightarrow,sloped] \arrow[dd,swap,"\Delta_A"] &&
            \W(\W(A)) \arrow[dd,"\Delta_{\W(A)}",near end,dotted] \arrow[dr,"\W(\W(g))",sloped] \\
            & \W(A') \arrow[rr,"\Delta_{A'}",pos=0.4,crossing over] &&
            \W(\W(A')) \arrow[dd,"\Delta_{W(A')}"] \\
            \W(\W(A)) \arrow[rr,"\W(\Delta_A)",near end,dotted] \arrow[dr,"\W(\W(g))"',sloped] && \W(\W(\W(A))) \arrow[dr,"\W(\W(\W(g)))",near end,dotted,sloped] \\
            & \W(\W(A')) \arrow[rr,"\W(\Delta_{A'})"] \arrow[from=uu,"\Delta_{A'}"',pos=0.58,crossing over] && \W(\W(\W(A')))
            \end{tikzcd}
    \]
    Since all the other faces of the cube commute and $\W (g)$ is surjective,
    the front face has to commute as well. By the same reasoning we get the~\refunitality axiom
    in the general case. 
    \begin{claim*}
        
        \begin{tikzcd}
            \W(A) \arrow[r,"\Delta_A"] \arrow[d,"\Delta_A"] \arrow[dr,phantom,"\#"]
             & \W(\W(A)) \arrow[d,"\W(\Delta_A)"] \\
            \W(\W(A)) \arrow[r,"\Delta_{\W(A)}"]
              & \W(\W(\W(A)))
        \end{tikzcd}
        commutes.
        
    \end{claim*}
    \begin{smallproof}
        evaluating the ghost coordinates leads to:
        \[
            \begin{tikzcd}
                \W(A) \arrow[r,"\Delta_A",] \arrow[d,"\Delta_A"] \arrow[rr,bend left,"F_A",dotted]
                 & \W(\W(A)) \arrow[d,"\W(\Delta_A)"] \arrow[r,"w",dotted] 
                 & \W(A)^{\N} \arrow[d,"\Delta_A^{\N}",dotted]\\
                \W(\W(A)) \arrow[r,"\Delta_{\W(A)}"] \arrow[rr,bend right,"F_{\W_A}",dotted]
                  & \W(\W(\W(A))) \arrow[r,"w",blue]
                  & \W(\W(A))^{\N}
            \end{tikzcd}  
        \]
        which by Proposition~\ref{prop: existence of diagonal} simplifies to the left of the
        following diagrams, now it suffices to show for an arbitrary n that the right diagram commutes.
        \begin{figure}[H]
        \centering
        \begin{subfigure}{0.4\textwidth}
        \centering
        %\phantomsection\label{name1}
        \begin{tikzcd}
            \W(A) \arrow[r,"F_A"] \arrow[d,"\Delta_A"] 
             & \W(A)^{\N} \arrow[d,"\Delta_A^{\N}"] \\
            \W(\W(A)) \arrow[r,"F_{\W(A)}"]
              & \W(\W(A))^{\N}
        \end{tikzcd}
        %\caption*{(cap1)}
        \end{subfigure}
        \hspace{2em}
        \begin{subfigure}{0.4\textwidth}
        \centering
        %\phantomsection\label{name2}
        \begin{tikzcd}
            \W(A) \arrow[r,"(F_n)_A"] \arrow[d,"\Delta_A"] 
             & \W(A) \arrow[d,"\Delta_A"] \\
            \W(\W(A)) \arrow[r,"(F_n)_{\W(A)}"]
              & \W(\W(A))
        \end{tikzcd}
        %\caption*{(cap2)}
        \end{subfigure}
        \end{figure}
        evaluating the ghost coordinates again, keeping in mind that 
        by~\ref{cor: A torsion-free implies W(A) torsion-free}
        and~\ref{lem: injective ghost map}, the map
        $w \colon \W(\W(A)) \to \W(A)^{\N}$ is injective as well, we get
        \[
            \begin{tikzcd}
                \W(A) \arrow[r,"(F_n)_A"] \arrow[d,"\Delta_A"] 
                 & \W(A) \arrow[d,"\Delta_A"] \arrow[dd,bend left = 60,"F_A",dotted]\\
                \W(\W(A)) \arrow[r,"(F_n)_{\W(A)}"] \arrow[d,"w",dotted]
                  & \W(\W(A)) \arrow[d,"w",blue] \\
                \W(A)^{\N} \arrow[r,"(\widetilde{F}_n)_{\W(A)}",dotted]
                & \W(A)^{\N}
            \end{tikzcd}
        \]
        using the fact that 
        \begin{tikzcd}
            \W(\W(A)) \arrow[d,"w",dotted] \arrow[rd,"w_{nm}",dotted]\\
            \W(A)^{\N} \arrow[r,"(\widetilde{F}_n)_{\W(A)}",dotted]
            & \W(A)^{\N}
        \end{tikzcd}
        commutes, we can simplify the situation to the left of the following two diagrams
        which can again be simplified to the right diagram for every $n$.
        \begin{figure}[H]
        \centering
        \begin{subfigure}{0.4\textwidth}
        \centering
        %\phantomsection\label{name1}
        \begin{tikzcd}
            \W(A) \arrow[r,"F_n"] \arrow[d,"\Delta_A"] \arrow[rd,"F_{nm}",dotted]
                 & \W(A) \arrow[d,"F_m"] \\
                \W(\W(A)) \arrow[r,"w_{nm}"] 
                  & \W(A)
        \end{tikzcd}
        %\caption*{(cap1)}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.4\textwidth}
        \centering
        %\phantomsection\label{name2}
        \begin{tikzcd}
            \W(A) \arrow[r,"F_n"] \arrow[rd,"F_{nm}"']
            & \W(A) \arrow[d,"F_m"]\\
            & \W(A)
        \end{tikzcd}
        %\caption*{(cap2)}
        \end{subfigure}
        \end{figure}
        Now this commutes by Lemma~\ref{lem: F_n after F_m is F_{nm}}, hence we are finished.
    \end{smallproof}
    \begin{claim*}
        \begin{tikzcd}
            \W(A) \arrow[d,"\Delta_A"'] \arrow[rd,"\id_{\W(A)}"]\\
            \W(\W(A)) \arrow[r,"\W(w_1)"']
            & \W(A) 
        \end{tikzcd}
        commutes.
    \end{claim*}
    \begin{smallproof}
        evaluate the ghost coordinates:
        \[
            \begin{tikzcd}
                \W(A) \arrow[d,"\Delta_A"'] \arrow[rd,"\id_{\W(A)}"] 
                \arrow[dd,bend right = 60,"F"',dotted]\\
                \W(\W(A)) \arrow[r,"\W(w_1)"'] \arrow[d,"w",dotted]
                & \W(A) \arrow[d,"w",blue] \\
                \W(A)^{\N} \arrow[r,"w_1^{\N}",dotted]
                & A^{\N}
            \end{tikzcd}
        \]
    we can then simplify to the left of the following diagrams.
    \begin{figure}[H]
    \centering
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name1}
    \begin{tikzcd}
        \W(A) \arrow[d,"F"'] \arrow[rd,"w"] \\
        \W(A)^{\N} \arrow[r,"w_1^{\N}"'] 
        & A^{\N}
    \end{tikzcd}
    %\caption*{(cap1)}
    \end{subfigure}
    \hspace{2em}
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name2}
    \begin{tikzcd}
        \W(A) \arrow[d,"F_n"'] \arrow[dr,"w_n"]\\
        \W(A) \arrow[r,"w_1"'] 
        & A
      \end{tikzcd}
    %\caption*{(cap2)}
    \end{subfigure}
    \end{figure}
    Again it suffices to show that
    for all $n$ the right of the two diagrams commutes, which is true by Lemma~\ref{lem: frobenius}.
    \end{smallproof}
    \begin{claim*}
        \begin{tikzcd}
            & \W(A) \arrow[d,"\Delta_A"] \arrow[ld,"\id_{\W(A)}"'] \\
            \W(A)  & \W(\W(A)) \arrow[l,"w_1"]
        \end{tikzcd}
        commutes.
    \end{claim*}
    \begin{smallproof} 
        Let $a \in \W(A)$. \\
        $w_1(\Delta_A(a)) = F_1(a) = a$,
        since $F_1 = \id_{\W(A)}$ by Lemma~\ref{lem: F_1 = id}.
    \end{smallproof}
    This concludes the proof.
\end{bigproof}
\section{The Teichmüller map induces a morphism of comonads}
Now consider the \textit{teichmüller map} $\tau \colon A \to \W(A); 
a \mapsto (a,0,0,0,\dots)$.
It is multiplicative and preserves the unit, hence it extends uniquely to 
a natural ring homomorphism
\[
\tau_A \colon \Z A \to \W(A)
\]
\begin{theorem} \label{thm: morphism of comonads}
    $\tau \colon \Z[\_] \Rightarrow \W(\_)$ is a morphism of comonads.
\end{theorem}
\begin{beweis}
    We need to show that the following diagrams commute:
    \begin{figure}[H]
    \centering
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name1}
    \begin{tikzcd}
        \Z A \ar[r,"\tau_A"] \ar[rd,"\eps_A"']
        & \W(A) \ar[d,"(w_1)_A"] \\
        &  A
    \end{tikzcd}
    %\caption*{(cap1)}
    \end{subfigure}
    \hspace{2em}
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name2}
    \begin{tikzcd}
        \Z A \arrow[r,"\omega_A"] \arrow[d,"\tau_A"] 
          & \Z \Z A \arrow[d,"\tau \otimes \tau"] \\
        \W(A) \arrow[r,"\Delta_A"]
          & \W(\W(A))
    \end{tikzcd}
    %\caption*{(cap2)}
    \end{subfigure}
    \end{figure}
    By the universal property of $\Z A$, it suffices 
    to consider elements of the form $[a]$ for $a \in A$.
    For the first diagram: $w_1(\tau([a])) = a = \eps([a])$.
    For the second diagram, arguing as before, it suffices to show commutativity
    after evaluating the ghost coordinates: 
    \[
        \begin{tikzcd}
            \Z A \arrow[r,"\omega_A"] \arrow[d,"\tau_A"] 
              & \Z \Z A \arrow[d,"\tau \otimes \tau"] \\
            \W(A) \arrow[r,"\Delta_A"] \ar[rd,"F_n"',dotted]
              & \W(\W(A)) \ar[d,"w_n",blue] \\
              & \W(A)
        \end{tikzcd}
    \]
    Note that $F_n(\tau([a])) = \tau([a^n])$ since evaluating the ghost coordinates 
    shows that the equation holds if $A$ is torsion-free (using~\ref{lem: frobenius}), and hence, in general.
    Using this, we see that $w_n(\tau \otimes \tau(\omega([a]))) 
        = w_n(\tau \otimes \tau([[a]]))
        = w_n((\tau([a]),0,\dots))
        = \tau([a])^n = (a^n,0,\dots)$
    and $F_n(\tau([a])) = \tau([a^n]) = (a^n,0,\dots)$.
    This concludes the proof.
\end{beweis}

