\chapter{Monads and Comonads}
\section{Definition of Monads and Comonads}
A central notion in algebra is that of a \textit{monoid},
that is, a set $M$ equipped with a map 
\todo{definitionen nicht nummerieren?}
$\mu \colon M \times M \to M$; $(a,b) \mapsto a \cdot b$ 
(often called \textit{multiplication}) and an element $e \in M$
such that the following two axioms hold:
\begin{align}
    \label{eq: associativity for a monoid}  \tag{associativity} 
    (a \cdot b) \cdot c = a \cdot (b \cdot c) 
    \quad &\text{for all} \ a,b,c \in M. \\
    \label{eq: identity element for a monoid} \tag{identity element}
    e \cdot a = a \cdot e = a \quad &\text{for all} \ a \in M 
\end{align}
We can give an equivalent definition in terms of maps and commuting diagrams as follows:
A \textit{monoid} is a set $M$ together with two functions 
\[
    \mu \colon M \times M \to M, \quad 
    e \colon \pt \to M
\]
such that the following diagrams commute: \\

\begin{figure}[H]
    \centering
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name1}
        \begin{tikzcd}
            M \times M \times M \ar[r,"\id \times \mu"] \ar[d,"\mu \times \id"] 
              & M \times M \ar[d,"\mu"] \\
            M \times M \ar[r,"\mu"]
              & M
        \end{tikzcd}
    %\caption*{(cap1)}
    \end{subfigure}
    \hspace{2em}
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name2}
        \begin{tikzcd}
            \pt \times M \ar[rd,"l"'] \ar[r, "e \times \id"] 
            & M \times M \ar[d,"\mu"] 
            & M \times \pt \ar[l,"\id \times e"'] \ar[ld,"r"]\\
            & M
        \end{tikzcd}
    %\caption*{(cap2)}
    \end{subfigure}
    \end{figure}


where $\id$ is the identity on m, and $l$ and $r$ are the canonical bijections
\begin{align*}
    &l \colon \pt \times M \to M;\ l(\ast,m) = m \\
    &r \colon M \times \pt \to M;\ r(m,\ast) = m.
\end{align*}

Explicitly, the first diagram means that for all $a,b,c \in M$:
\[
    (a \cdot b) \cdot c = a \cdot (b \cdot c) 
    \quad \text{for all} \ a,b,c \in M.
\]
which is verbatim the~\ref{eq: associativity for a monoid} axiom, the second diagram means that for all $m \in M$:
\[
  e(\ast) \cdot m = l(\ast,m) = m = r(m,\ast) = m \cdot e(\ast)  
\]
which is clearly the~\ref{eq: identity element for a monoid} axiom 
for the element $e(\ast)$.
This motivates the following definition: \todo{monoid/monad/ monoid object}
\begin{definition}[Monad]
A \textit{Monad} $(T,\mu, \eta) $ in a category $\mathcal{X}$ consists of
\begin{itemize}
    \item an endofunctor $T\colon \mathcal{X} \to \mathcal{X}$
    \item a natural transformation $\eta \colon \id_\mathcal{X} \Rightarrow T$ 
    \item a natural transformation $\mu\colon T^2 \Rightarrow T $
\end{itemize}  
such that the following diagrams commute: \\
% der ' nach dem Text Ã¤ndert die Position der Pfeil-Beschriftung
\begin{figure}[H]
    \centering
    \begin{subfigure}{0.3\textwidth}
        \centering
        \phantomsection\label{dia: unitality}
        % Content of the first subfigure
        \begin{tikzcd}
            T^3 \ar[r,"T\mu",Rightarrow] \ar[d,"\mu T"',Rightarrow] 
            & T^2 \ar[d,"\mu",Rightarrow] \\
            T^2 \ar[r,"\mu",Rightarrow]
            & T
        \end{tikzcd}
        \caption*{(unitality)}
    \end{subfigure}
    \hspace{2em}
    \begin{subfigure}{0.3\textwidth}
        \centering
        \phantomsection\label{dia: associativity}
        \begin{tikzcd}
            T \ar[rd,"\id_T"',Rightarrow] \ar[r, "\eta T",Rightarrow] 
        & T^2 \ar[d,"\mu",Rightarrow] 
        & T \ar[l,"T \eta"',Rightarrow] \ar[ld,"\id_T",Rightarrow]\\
        & T
        \end{tikzcd}
        \caption*{(associativity)}
    \end{subfigure} 
\end{figure}

In terms of components,~\refunitality and~\refassociativity mean that for every object $x$ of $\mathcal{X}$
the following diagrams commute:

\begin{figure}[H]
\centering
\begin{subfigure}{0.4\textwidth}
\centering
%\phantomsection\label{name1}
\begin{tikzcd}
    T(T(Tx)) \ar[r,"T(\mu_x)"] \ar[d,"\mu_{Tx}"'] 
    & T(Tx) \ar[d,"\mu_x"] \\
    T(Tx) \ar[r,"\mu_x"]
    & Tx
\end{tikzcd}
\caption*{(unitality)}
\end{subfigure}
\hspace{2em}
\begin{subfigure}{0.4\textwidth}
\centering
%\phantomsection\label{name2}
\begin{tikzcd}
    Tx \ar[rd,"\id_{Tx}"'] \ar[r, "\eta_{Tx}"] 
    & T(Tx) \ar[d,"\mu_x"] 
    & Tx \ar[l,"T(\eta_x)"'] \ar[ld,"\id_{Tx}"]\\
    & Tx
\end{tikzcd}
\caption*{(associativity)}
\end{subfigure}
\end{figure}

\end{definition}

\begin{example}[preorder]
Recall: A \textit{preorder} $(\mathcal{P},\le)$ is a category with $\mathcal{P}$ as objects and 
a morphism between $X$ and $Y$ iff $X \le Y$.
A functor $T\colon \mathcal{P} \to \mathcal{P}$ is thus a monotonic function $\mathcal{P}\to \mathcal{P}$
($x \le y \implies Tx\le Ty$).
The existence of the natural transformations $\eta$ is equivalent to
\[x \le Tx \ \forall x \in \mathcal{P}\]
and the existence of $\mu$ is equivalent to
\[T(Tx) \le Tx \ \forall x \in \mathcal{P}\] 
because there is at most one morphism $x \to y$, so the neccessary diagrams commute trivially.\\
Now suppose $\mathcal{P}$ is a \textit{partial order}, i.e. $x \le y \le x \implies x = y \ \forall x,y \in \mathcal{P}$. \\
Then:
\begin{align*}
    x \le Tx \implies Tx \le T(Tx) \\
    T(Tx) \le Tx \implies Tx = T(Tx)
\end{align*}
so a Monad $T$ in a partial order $\mathcal{P}$ is a \textit{closure operation} in $\mathcal{P}$, i.e. 
a monotonic function $T \colon \mathcal{P} \to \mathcal{P}$ 
with $x \le Tx$ and $T(Tx)=Tx \ \forall x \in \mathcal{P}.$ \\
Now every topological space $X$ induces a partial order $\mathcal{P} = (\mathscr{P}(X),\subseteq)$.
Here an example for a closure operation is taking the topological closure $A \mapsto \overline{A}$,
since it holds for all $A \subseteq X$ that $A \subseteq \overline{A}$ and
$\overline{\overline{A}} = \overline{A}$.
\end{example}

\begin{definition}[Comonad]
A \textit{Comonad} $(L,\eps, \omega) $ in a Category $\mathcal{A}$ consists of
\begin{itemize}
    \item an endofunctor $L\colon \mathcal{A} \to \mathcal{A}$
    \item a natural transformation $\eps \colon L \Rightarrow \id_{\mathcal{A}}$ 
    \item a natural transformation $\omega\colon L \Rightarrow L^2 $
\end{itemize}  
such that the following diagrams commute:

\begin{figure}[H]
\centering
\begin{subfigure}{0.4\textwidth}
\centering
%\phantomsection\label{name1}
    \begin{tikzcd}
        L \ar[r,"L\omega",Rightarrow] \ar[d,"\omega L"',Rightarrow] 
            & L^2 \ar[d,"L\omega",Rightarrow] \\
        L^2 \ar[r,"\omega L",Rightarrow]
            & L^3
    \end{tikzcd}
\caption*{(counitality)}
\end{subfigure}
\hspace{2em}
\begin{subfigure}{0.4\textwidth}
\centering
%\phantomsection\label{name2}
    \begin{tikzcd} 
        & L \ar[ld,"\id_L"',Rightarrow] 
        \ar[rd,"\id_L",Rightarrow] \ar[d,"\omega",Rightarrow] & \\
        L 
        & L^2 \ar[l,"\eps L"',Rightarrow] \ar[r,"L \eps",Rightarrow] 
        & L
    \end{tikzcd}
\caption*{(coassociativity)}
\end{subfigure}
\end{figure}


In terms of components, this means that for every object $x$ of $\mathcal{A}$
the following diagrams commute:

\begin{figure}[H]
\centering
\begin{subfigure}{0.4\textwidth}
\centering
%\phantomsection\label{name1}
    \begin{tikzcd}
        Lx \ar[r,"L(\omega_x)"] \ar[d,"\omega_{Lx}"'] 
            & L(Lx) \ar[d,"L(\omega_x)"] \\
        L(Lx) \ar[r,"\omega_{Lx}"]
            & L(L(Lx))
    \end{tikzcd}
\caption*{(counitality)}
\end{subfigure}
\hspace{2em}
\begin{subfigure}{0.4\textwidth}
\centering
%\phantomsection\label{name2}
    \begin{tikzcd}
        & Lx \ar[ld,"\id_{Lx}"'] 
        \ar[rd,"\id_{Lx}"] \ar[d,"\omega_x"] & \\
        Lx 
        & L(Lx) \ar[l,"\eps_{Lx}"'] \ar[r,"L(\eps_x)"] 
        & Lx
    \end{tikzcd}
\caption*{(coassociativity)}
\end{subfigure}
\end{figure}

\end{definition}

\begin{lemma}
    For every object $x$ in $\mathcal{X}$, the following diagram commutes:
    \[
      \begin{tikzcd}
        T(Tx) \arrow[r,"T(\delta_x)"] \arrow[d,"\delta_{Tx}"] 
            & T(T'x) \arrow[d,"\delta_{T'x}"] \\
          T(T'x) \arrow[r,"T'(\delta_x)"]
            & T'(T'x)
      \end{tikzcd}
    \]
    this means \[
        \delta T' \circ T \delta = T' \delta \circ \delta T
        \colon T^2 \Rightarrow (T')^2.
    \]
\end{lemma}
\begin{beweis}
    $\delta \colon T \Rightarrow T'$ is natural.\todo{finish proof}
\end{beweis}
\begin{definition}[Morphism of monads]
    Let $\mathcal{X}$ be a category, let $(T,\eta,\mu)$ and $(T',\eta',\mu')$ be monads in $\mathcal{X}$.
    We say that a natural transformation $\nat[\delta]{T}{T'}$ is a \textit{morphism of monads} if it preserves
    the unit and the multiplication, i.e. the following diagrams commute:

    \begin{figure}[H]
    \centering
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name1}
        \begin{tikzcd}
            \id_x \ar[rd,"\eta'_x"'] \ar[r, "\eta_x"] 
            & Tx \ar[d,"\delta_x"] \\
            & T'x
        \end{tikzcd}
    %\caption*{(cap1)}
    \end{subfigure}
    \hspace{2em}
    \begin{subfigure}{0.4\textwidth}
    \centering
    %\phantomsection\label{name2}
        \begin{tikzcd}
            T^2x \ar[r,"\mu_x"] \ar[d,"\delta T' \circ T\delta"'] 
            & Tx \ar[d,"\delta_x"] \\
            T'^2x \ar[r,"\mu'_x"]
            & T'x
        \end{tikzcd}
    %\caption*{(cap2)}
    \end{subfigure}
    \end{figure}
    %vadjust allows todo in math-mode   
\end{definition}
\begin{definition}[Morphism of comonads]
\end{definition}